function x = solvep4a(A,B,C,D,E)
% SOLVEP4A
% DO NOT USE. This is buggy code. It should be 4x faster than solvep4, but it is WRONG.
% Solve A*x^4 + B*x^3 + C*x^2 + D*x + E = 0.
% First, divide all terms by A.

B=B/A;
C=C/A;
D=D/A;
E=E/A;

% So now we're solving x^4 + B*x^3 + C*x^2 + D*x + E = 0.
% Write x = y - B/4.
% Then x^4 = y^4 - B*y^3 + 3/2*B^2*y^2 - 1/16*B^3*y + 1/256*B^4  [*1]
%      x^3 =         y^3 - 3/4*B  *y^2 + 3/16*B^2*y - 1/64 *B^3  [*B]
%      x^2 =                       y^2 - 1/2 *B  *y + 1/16 *B^2  [*C]
%      x   =                                      y - 1/4  *B    [*D]
%      1   =                                                1    [*E]
% Add them all up:
%   0 = y^4 
%       + (3/2*B^2 - 3/4*B^2 + C)*y^2 + 
%       + (-1/16*B^3 + 3/16*B^3 - 1/2*B*C + D)*y +
%       + (1/256*B^4 - 1/64*B^4 + 1/16*B^2*C - 1/4*B*D + E.
a = 3/4*B^2 + C;
b = 1/8*B^3 - 1/2*B*C + D;
c = -3/256*B^4 + 1/16*B^2*C - 1/4*B*D + E;

y = [  1/12*6^(1/2)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)+1/12*(-(48*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)+6*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+288*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*c+24*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*a^2+72*b*6^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)/((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2))^(1/2);
  1/12*6^(1/2)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)-1/12*(-(48*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)+6*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+288*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*c+24*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*a^2+72*b*6^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)/((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2))^(1/2);
  -1/12*6^(1/2)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)+1/12*(-(48*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)+6*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+288*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*c+24*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*a^2-72*b*6^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)/((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2))^(1/2);
  -1/12*6^(1/2)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)-1/12*(-(48*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)+6*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+288*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*c+24*((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2)*a^2-72*b*6^(1/2)*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)/((-4*a*(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3)+(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(2/3)+48*c+4*a^2)/(-288*a*c+108*b^2+8*a^3+12*(-768*c^3+384*c^2*a^2-48*c*a^4-432*a*c*b^2+81*b^4+12*b^2*a^3)^(1/2))^(1/3))^(1/2))^(1/2)];
x = y - B/4;
